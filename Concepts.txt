--===============================--
--[[ BUDGET
--===============================--

calculate need (ie maintenance cost, then bonus if superior, malus if inferior)

military :
	- moral (combat: retreat)
	- reliability (mechanized need less materiel to repair, vehicule can become damaged each turn)
	- loyalty (desertion, rebellion, linked to moral and empire stability)
	- suply line efficiency

culture

diplomacy
	- less envoys
	- faster decay of positives modifiers
	- slower decay of negative modifiers

intelligence

entertainement
	- low budget lower the benefits of entertainement budget or policies
	- no over budget

science

infrastructure : 
	- if not enough budget, roads, buildings, improvements can be damaged (decay rate)
	- lower auto-repair time

--]]

--===============================--
--[[ BUILDERS
--===============================--


- Recharge each turn with materiel
- Give a charge if materiel > 200 (or another value)
- Use materiel on action
- Do not kill on use

--]]

--===============================--
--[[ BUILDINGS
--===============================--

+ Resources creation

	- Iron stock in city -> Iron Smith -> produce Materiel
	- Iron & coal stock in city -> Steel Factory -> produce Steel

+ Resource stock

	- New table 'BuildingStock' ('BuildingType', 'ResourceType', 'Value')
	- Granary -> can stock 15 units of Rice, Wheat

+ replacing building
	- bonus in prod when previous building in city
	- lua script to replace the old building on completion

+ new buildings
	- River docks : allow resource trade/transfer following rivers
	- Assembly : raise stability, raise separatism
	- Treadmills : convert wheat/rice to food (mutually exclusive with Rivermills)
	
+ Special resources buildings
	- to stock special resources (aka "Equipment", example: Iron Materiel)
	- no stock for special resources outside production buildings and those buildings
	- temporary buildings created when an unit required special resources is linked to a city ?
	
--]]

--===============================--
--[[ CITIZEN NEEDS
--===============================--

- Citizen have consumers need for resources depending on their social class, city size and the era
    + food (upper, middle, lower, slaves)
    + medicine for those who have a disease (upper, middle, lower, slaves)
    + basic clothes (middle, lower, slave) = linen (plants from forest/jungle/swamp) or leather or wool
    + clothes (upper, middle) = use leather + (wool or linen)
    + exotic food (upper, middle) = food not available on the civilization territory (and continent)
    + rare food (upper)
    + luxury clothes (upper) = use leather + (wool or linen) + (dyes or furs or coton) | or simply just clothes + (dyes or furs)
    + luxury products (upper) = jewelry (silver, diamonds), decorations (silver, marble)
   
- when all needs of a class are meet, give a bonus to birth rate
- if a basic need (food, medicine, basic clothes - and more with eras) can't be satisfied (high cost or shortage), lower local stability

- table1
	NeedType
	ResourceType
	PopulationType
	StartEra
	EndEra
	SquareRatio 			-> √(pop) * ratio 
	FactorRatio				-> (pop * ratio)
	NeededCalculType		-> SQUARE_ROOT, FACTOR, MINIMAL(SQUARE_ROOT, FACTOR), MAXIMAL(SQUARE_ROOT, FACTOR)
	OnlyBonus				-> only apply effect if stock > needed
	OnlyPenalty				-> only apply effect if stock < needed
	EffectType				-> HUNGER, ...
Key(NeedType, ResourceType, PopulationType)
	
table2
	EffectType				-> Same as table 1
	PopulationType			-> Same as table 1
	AffectedType			-> DEATH_RATE, BIRTH_RATE, STABILITY, ...
	EffectCalculType		-> DIFF (max(0,needed-stock)) | PERCENT (MaxEffectValue*(100-stock/needed*100))	  or needed/stock if stock > needed
	MaxEffectValue			-> max value for the result of EffectCalculType
	Treshold				-> don't apply value under that Treshold
	EffectAppliedType		-> ADD, MINUS, ADD_PRECENT, MINUS_PERCENT
	Ratio					-> Value * ratio applied to AffectedType using EffectAppliedType
Key(EffectType, PopulationType, AffectedType)
	
	NEED_FOOD	RESOURCE_FOOD	POPULATION_ALL	0.5	0.0005	MINIMAL	ADD	PERCENT	25
	
	B4 = pop, A5 = FactorRatio, A4 = SquareRatio
	needed = ARRONDI(MIN(B4*$A$5;(RACINE(B4)*$A$4)))
	needed with FactorRatio = ARRONDI(B4*$A$5)
	needed with SquareRatio = ARRONDI(RACINE(B4)*$A$4)

chunk = loadstring("local a, b, c = ...;") -- In 5.1, chunks are compiled as vararg functions, not as functions of no arguments.
	
or	

chunk = loadstring("return function(a, b, c) " .. chunkstring .. " end")() -- "double call" mechanism
	
--]]
	
--===============================--
--[[ CITY GROWTH
--===============================--

BirthRate = total number of live births per 1,000 of a population in a year = 22.5 in 2000, 37.2 in 1950 (50 max, 6 min in 2000)
MortalityRate = units of deaths per 1,000 individuals per year = 8.8 in 2000, 19.1 in 1950 (17 max, 1 min in 2000)
GrowthRate = BirthRate - MortalityRate

UpperClassBirthRate 	= 5
MiddleClassBirthRate 	= 15
LowerClassBirthRate		= 50
SlaveBirthRate			= 20

National values
	policies, techs
	
City values
	health, food (mortality rate)
	housing (birth rate)

--]]

--===============================--
--[[ CIVS RELATIONS
--===============================--

table
[CivID1]
	[CivID2] = { Thrust = { [ModifierID] = value, ...}, Relation  = { [ModifierID] = value, ...}}
	[CivID3] = ...
	
thrust modifiers
	Break Treaty with an enemy civ = -10 (decay +1/turn) (maybe use % rate of decay instead of fixed value)
	Break Treaty with another civ = -25 (decay +1/turn)
	Break Treaty with a friend civ = -50  (decay +1/turn)
	Break Treaty with us = -100 (decay +2/turn)
	declare a surprise war with an enemy civ = -5 (decay +1/turn)
	declare a surprise war with another civ = -25 (decay +1/turn)
	declare a surprise war with a friend civ = -100  (decay +2/turn)
	declare a surprise war with us = -200 (decay +3/turn)
	Respect Treaty with us = +1/turn with treaty (reset to 0 when breaking a treaty with us)
	Respect delayed deal = +2/deal (reset to 0 when breaking a delayed deal with us)
	Respect other civ delayed deal = +1/deal (reset to 0 when breaking a delayed deal with another civ)
	spy actions
	
relation modifiers
	send delegation				= +5
	ambassy						= +10 when active
	open border					= +5 when active
	open market					= +15 when active
	defensive pact				= +25 when active
	non agression pact			= +10 when active
	common friend				= +5 per friend (declaration of friendship)
	common enemy				= +10 per enemy (enemy = at war or denounced)
	friend of an enemy			= -15 per friend
	territory (give)			= +5 per tile (decay -1/turn) } when it's part of a demand or peace treaty, it won't count when part of a deal.
	territory (taken)			= -5 per tile (decay +1/turn) } 
	occupy territory 			= -2 per tile (occupied territory = tile captured with still a majority of the previous owner culture)
	occupy territory of a friend= -1 per tile
	occupy city 				= -20 per city (occupied city = city captured with still a majority of the previous owner culture)
	occupy city of a friend		= -10 per city
	territorial integrity		= +10 when active
	research agreement			= +10 when active
	same side in war			= +50 when active
	declaration of friendship	= +50 when active
	information from spy		= +25 (decay -1/turn)
	information sharing			= +10 when active
	garanteed access for trade	= +1 (bonus), +2 (strategic), +5 (luxuries) per resource type when active
	embargo						= -2 (bonus), -5 (strategic), -10 (luxuries) per resource type when active
	denounciation				= -100 when active
	at war						= -200 when active
	break delayed deal			= -25 (decay +1/turn)
	break territorial integrity = -20 (decay +1/turn)
	break defensive pact		= -100 (decay +2/turn)
	break non agression pact	= -200 (decay +3/turn)
	break embargo				= -20 (decay +1/turn)
	break open border			= -20 (decay +1/turn)
	break DOF					= -50 (decay +2/turn)
	refuse to denounce			= -10 (decay +1/turn)
	refuse to remove embargo	= -25 (decay +1/turn)
	refuse to stop DOF			= -15 (decay +1/turn)
	refuse to stop def. pact	= -10 (decay +1/turn)
	refuse to stop open borders	= -10 (decay +1/turn)
	refuse to stop open market	= -10 (decay +1/turn)
	refuse to give gold			= -10 (decay +1/turn)
	spy actions
	opposing governments

--]]

--===============================--
--[[ COMBAT
--===============================--

when destroying an unit in melee attack:
- capture % of wounded left
- capture % of materiel left
- capture % of horses left
- capture % of fuel left
- transform % of damaged vehicule to materiel

when destroying an unit in ranged attack:
- few % of wounded left -> defender city if linked
- everything else lost
- to do: leave materiel, fuel (wounded ? Horses ?) on the plot using assets

---------------------------------------------------------------

+ Units can have more components than expected by its HP left (just put them in reserve as surplus)

- excedental reserve is transfered to city if a supply line is open
- if excedent > max active then the component is lost (that situation shouldn't happen)

example:
- desertion in a mechanized units: remove the HP corresponding to the deserting personnel and put the Equipment corresponding to the HP lost in reserve.
- mechanical failure in case of low reliability: remove the HP corresponding to the Equipment damaged and put the personnel corresponding to the HP lost in reserve.
- chance of ejection/escape of the crew of an aircraft/vehicule destroyed in combat situation : when removing each Equipment corresponding to the HP lost in combat do a check and put unarmed crew in reserve (or wounded)

--]]

--===============================--
--[[ CULTURE RELATION
--===============================--

relation with other culture groups

lower
	being at war
	denounced
	opposed government
	
raise
	being friend
	being allied
	same governement

--]]

--===============================--
--[[ DIPLOMACY
--===============================--

diplomacy action require envoys
	need X envoys for a meeting with X civs (but the envoys are removed only if a decision is made)

deal/treaty
	can be public or secret
		spy network can reveal secret deals
		civ concerned (directly or indirectly) by the secret deal can be offended if they find out
	can be delayed (x turns) or immediate
	in case of public and delayed deal, civ concerned (for example civA had territorial integrity treaty with civB but ask for territory, civC has also integrity treaty with civA and is now concerned that A may not respect it) can warn about it
	
type of deal (things that will be exchanged immediatly)
	territory: ask for territory in which a civ has a majority of culture
	joint declaration of war (can prepare coalition with delayed deal, civA ask civB for joint war and B accept under reserve that x civs join the coalition)
	information from spy
	send delegation (with or without spy)
	introduce to another civ
	borders map
	
type of demand
	ask to denounce
	ask to give territory in which a civ has a majority of culture
	ask to remove embargo
	ask to stop declaration of friendship
	ask to stop defensive pact
	ask to stop open borders
	ask to stop open market
	ask for gold
	
type of treaty (things that will take effects for a specified duration)
	fixed borders: no tile flipping from culture without trading them between those civilizations
	territorial integrity: recognize borders, engagement to not make demand of territory based on culture %
	defensive pact
	non agression pact
	open borders
	declaration of friendship
	open market: automatic trade alongs routes type without using a trader unit, like for internal routes
	engagement to not start an embargo of any resource
	information sharing against another civ (civA and civB share spy informations about civC)
	garanteed access for trade to a % of specific resources (which means priority access for civ A to that resource over civ B own industry and units)
	embargo of specific resources against another civ (civA and civB agree to not trade a resource with civC)
	denounciation (not a "treaty", but use the same mechanism)
	ambassy
	research agreement
	
type of alliance (an alliance can cover multiple domain, an alliance can only be created to oppose another civ or alliance)
	economic
		can vote embargo against a civ that is not part of the alliance or against another alliance
		automatic open market
	militaristic (pact)
		can vote joint war against a civ that is not part of the alliance or against another alliance
		automatic defensive pact
		automatic non agression pact
	diplomatic (federation)
		automatic open borders
		automatic non agression pact
		automatic territorial integrity
	research
		automatic research agreement

war
	create a new entry in war table when a new war start:
		- warID
		- startDate
		- endDate
		- SideA = {[civID1] = {Death, Kills, startTurn, endTurn}, ... }
		- SideB = {}
	auto-create sides: civ A at war with civ B, civ C enter war against A, auto-side with B	
	a civ may not be at war with all civs from other side
	a civ can't declare war to a civ of the same side before making peace with the other side but a civ can change side in a war (peace treaty condition, ...)
	
peace treaty
	can be individual or collective
	territory (gain/loss using a fixed % of culture from winner, the % could raise with larger victory)
	change government type
	change side in a war
	open market
	open border
	
casus belly
	territory (refuse to give plots with a majority of culture)
	non-respect of a treaty (peace, commerce, military)
	refuse a "fair" demand (like removing embargo, third party civ asking the strong side to accept a compensated peace in an asymetric war they've started)
	spy actions

--]]

--===============================--
--[[ DISTRICTS
--===============================--

- remove Culture, Faith, Entairtainment districts
- add internal city districts concept with limited slots 
- "City expansion" improvement to unlock most districts (build adjacent to city center or another district)
- Airport, Space, Encampement must be build > 1 tile from city center / expansion

--]]

--===============================--
--[[ ECONOMIE
--===============================--

+ Give a local "consumer cost" to resources in a city (deduct a national cost = average from all cities ?)

	Cost goes up when high demand (+++) and source is transfer (+) or import (++)
	Cost goes down when low demand (---) and source is local (-)
	Production cost = (ΣCostRequiredResources or resourceBaseCost) * cityWealth
	transport cost = +% of production cost (% = 100 - route efficiency)
	possible use : 
		Some resources (like iron) could be exctracted in any mines even if the resource is not on the plot but at a lower rate and much higher cost
		Producing an unit require resources (at least materiel), cost of construction per turn is related to the required resources cost and city wealth


+ 4 classes: upper, middle, lower, slave (prisonners of war, policy dependant)

	rich (max % from middle+poor), middle (default), poor
	rich give more gold from tax
	poor, slave give no gold from tax
	building / luxury resources / tax : change rate (per turn) of convertion from middle to rich/poor
	poor give unrest/unhappiness
	slaves give extra production, raise unrest
	wealth level of a city = ((2x upper) + (1x middle) + (0.5x lower) + (0.1x slaves)) / totalPopulation

Taxe rate used to determine gold the change rate

default value
BASE_GOLD_PER_RICH_CITIZEN = 100
BASE_TAXE_RICH_CLASS = 10

BASE_GOLD_PER_MIDDLE_CLASS_CITIZEN = 10
BASE_TAXE_RICH_CLASS = 10

UI :
    - national taxe rate
       - 2 values for rich/middle class taxe rate
    - city taxe rate
       - 2 values for rich/middle class taxe rate
       - 1 button to reset city values to national values
	   
+ Corruption

Large empire raise corruption
Corruption lower incomes (maybe only if the budget is positif ?)	   

+ Banditism

some entertainement buildings raise banditism (taverns, whorehouses, nightclubs, ...)
banditism raise corruption
--]]	   

--===============================--
--[[ EQUIPMENT
--===============================--

- add check for unit obsolecence, only build equipment if unit type available (ie tech ready and not obsolete) or still active unit in army
- equipment are special resources

--]]

--===============================--
--[[ HEALING
--===============================--

- Unit "heal" from reserve first then receive supply in reserve : "Rear" (Reinforcement / Healed / Repaired) -> Reserve -> Frontline 
- Retreating: lose all damaged Equipment & wounded -> prisoners
- Need personnel to resuply #personnel in reserve
- Need materiel to resuply #Equipment in reserve
- Tribal Villages (Barbarian outpost ?) should provide enough Personnel / Materiel to refill at least a Scout/Ranger reserve.

+ each turn:

	- if linked to city: 
		all wounded, prisonners (and other captured components like horses, vehicule ?) -> city (if it can handle it)
		all excedent from other components -> city (if it can handle it)
		healing 10 "equivalent HP" max / turn from reserve, reserve receive 5 "equivalent HP" max / turn from cities

		infantry
			- reserve -> personnel/materiel to frontline troops (up to 10 equivalent hp) (reserve personnel + wounded can't be superior to max frontline personnel)
			- linked city - > component (personnel, horses, materiel) to refill reserve (up to 5 equivalent hp)

		mechanized unit
			- reserve -> personnel/materiel/vehicule to frontline troops (up to 10 equivalent hp)
			- linked city -> component (personnel, materiel) to refill reserve (up to 5 equivalent hp or until MAX_MATERIEL_SUPPLIED is reached, whatever come first)
			- linked city -> materiel to repair each damaged vehicule in reserve (max 5 hp of equivalent vehicule or until MAX_MATERIEL_SUPPLIED is reached, whatever come first)
			- linked city -> materiel ("vehicule production" here) to reserve (if not reached the 5 hp/turn limit or until MAX_MATERIEL_SUPPLIED is reached, whatever come first)

		note: materiel in reserve is only used to repair, not to make a new vehicule "on the field"

	- if not linked to city: 

		wounded -> % healed to reserve personnel (if medic/field hospital promotion)
		wounded -> % dead (more important without medic/field hospital promotion, lowered at higher eras)

		healing 10 "equivalent HP" max / turn from reserve

		infantry
			- reserve -> personnel/materiel to frontline troops (up to 10 equivalent HP)

		mechanized unit
			- reserve -> personnel/materiel/vehicule to frontline troops (up to 10 equivalent hp)
			- reserve -> materiel to repair each damaged vehicule (up to 5 equivalent vehicule HP)
			if no materiel in reserve, "bleed" unit
		
--]]

--===============================--
--[[ HEALTH
--===============================--

raise
	food variety
	health buildings
	forest
	
lower
	surpopulation
	jungle
	swamp
	pollution buildings
	
each turn:
health = health + (raise - lower) and -100 < health < 100

if health = 100 	:  0% disease in population |
if health = 0		:  2% disease in population } should those values should change with era/tech/buildings ?
if health = -100 	: 25% disease in population |

% disease generate need of medicine
% disease raise Mortality rate
plants -> heborist/apothicary -> medicines

if health < -50 : add value = rnd(1, abs(health)-50) to each possible epidemic disease buckets
if health > 0 : remove (% ? all ?) health value each turn to all buckets
when an epidemic disease reach its declaration treshold, create it and restore its value to 0 while it last in the city

the epidemy may spread to each city linked to this one, depending on their own health (maybe raise their own bucket faster for that epidemy ?)

Epidemy[cityKey][diseaseID] = { startDate, initialcityPop, deaths, strength, endDate }

lower strength each turn (with bonus for health > 0)
stop when strengh = 0 or % of initialCityPop killed
use endDate for buffer or filling a new bucket enough ?

--]]

--===============================--
--[[ HOUSING
--===============================--

can we represent housing with 3D models ?
	build houses with ethnicity
	keep ethnicity/ancient house model until upgraded
	
over population lower birth rate (unless already < to death rate) until it equals death rate
--]]

--===============================--
--[[ LOYALTY
--===============================--

- units loyalty is following the stability of the city it's linked to
- variation speed is dependant of moral
- loyalty lower when not linked to a city

--]]

--===============================--
--[[ MORAL
--===============================--

++ victory
++++ large victory
+++++ kill unit
- defeat
-- large defeat
- rationing
+++ friendly tribe

each turn @low morale (default = 50%) : desertion (modifiers to default: promotions, policies, ...)
	- remove 1 equivalent hp on personnel in reserve per turn until 50% MaxPersonnelReserve is reached
	- if less than 50% MaxPersonnelReserve remove 1 hp per turn until hp = 50% max (equivalent hp of personnel removed, other components transfered to reserve)
	- morale++
	
each turn
	- morale+ if enough food
	- morale+ if less than 25% of total personnel wounded
	- morale++ if victory in the last combat (5 turns max)
	- morale+++ if large victory in the last combat (5 turns max)
	- morale+++++ if killing enemy unit in the last combat (5 turns max)
	- morale- if more than 5% of total personnel wounded
	- morale- if more than 50% of total personnel wounded
	- morale- if defeat in the last combat (5 turns max)
	- morale-- if large defeat in the last combat (5 turns max)

--]]

--===============================--
--[[ POLICIES
--===============================--

Military cards policies:
	- Foreign Legion : can draft foreign citizens in the army
	- Both sex in the army : can draft more citizen, lower birth rate

--]]	

--===============================--
--[[ PROGRAMMATION
--===============================--
	   
- Create a configuration table set in one SQL file with the new mechanisms and values for units, buildings, etc...
- A copy of this table will be created in each database context (config, gameplay, text)
- Update each database with a separate specific SQL file

--]]

--===============================--
--[[ PROMOTIONS
--===============================--

- berserk/totenkopf : +25% chance of causing retreat, more dead, less prisonners, less wounded 

--]]

--===============================--
--[[ RATIONS
--===============================--

- food reserve
- get food from unit plot (or nearby plot at lower ratio)
- food requirement = ( (personnel x2) + (wounded *1.5) + (prisonners*0.5) + (horses*3) ) / 1000
- no food from owned plots
- pillaging can give food (farm, ...), materiel (mines, ...), prisonners (district, ...)

+ rationing
	if less than 50% MaxFoodStock left
		moral-, 50% food consumption, wounded mortality rate+
	if less than 25% MaxFoodStock left
		moral--, 25% food consumption, wounded mortality rate++
	if less than 10% MaxFoodStock left
		moral---, 10% food consumption, wounded mortality rate+++
		if unit has horses
			% of horses (min of 1) removed from reserve -> food 
	if no food stock
		moral----, wounded mortality rate++++
		if unit has horses
			% of horses (min of 1) removed from reserve -> food
			if no horses in reserve and more than 50 hp left in unit, remove 1hp (equivalent hp of horses removed -> food, other components transfered to reserve)

--]]

--===============================--
--[[ RESOURCE STOCK
--===============================--

how to find which resources can be sold & which can be bought

- slider to sell until X % of stock left 
- slider to buy until Y % of stock filled
- slider to convert to another resource until Z % of stock left

converting a resource (in buildings like steel factory using coal and iron) has priority, so to always have a stock to sell, set Z > X, but the number of converted / buyed resources is limited per turn

for example a market could allows 10 units of each resources / turn or a stock exchange 100 units of each resources / turn


if X > Y 
    - will buy until Y % of stock filled
    - will sell until X % of stock left
    - and means will not buy if it's selling
if X < Y 
    - will always buy until Y % of stock filled
    - will sell until X % of stock left
    - can buy and sell at the same time

so maybe force X >= Y every time (if X = Y = % stock left -> no buying nor selling)

default values:
PERCENTAGE_STOCK_REQUIRED_TO_SELL = 50
PERCENTAGE_STOCK_REQUIRED_TO_CONVERT = 40
PERCENTAGE_STOCK_REQUIRED_TO_STOP_BUYING = 50

UI :
    - national stock (main menu on new screen)
       - general slider for nation (ie default for all resources)
       - sliders for all resources (when used not updated by general slider)
       - button to reset values of all resources slider to general slider
    - city stock (list and button to unfold at bottom of new screen)
       - general slider for city (ie default for all resources in city - override general slider for nation at the city level)
       - sliders for all resources (when used they are not updated by general slider)
       - button to reset values of all resources slider to general slider for city
       - button to reset value of general slider for city to general slider for nation
       - button to reset values of all sliders of this city to general slider for nation

--]]
	   
--===============================--
--[[ RESOURCE STOCK (REVISED)
--===============================--

to do: always transfer excedents

MIN_PERCENT_LEFT_TO_SELL 		-- Selling to another Civ
MIN_PERCENT_LEFT_TO_CONVERT		-- Converted in local industry
MIN_PERCENT_LEFT_TO_SUPPLY		-- Used to reinforce units
MIN_PERCENT_LEFT_TO_TRANSFER	-- Transfered to other cities

MAX_PERCENT_LEFT_TO_BUY			-- Buying from another civ 
MAX_PERCENT_LEFT_TO_REQUEST		-- Transfered from other cities

Proceed on new turns for all civs at once ?

1st loop on units
	build linked units table
	
1st loop on cities
	build linked cities table (river, sea, road, trader, airport)
	collect resources in city plots (allow excedent)
	get supply demand (units linked to that city)
	get industry demand (local buildings that convert resources)
	create requests/buy values (based on current stocks minus supply/industry demands)
		keep request in cache for whole turn, reserve a part for each traders ?
	
2nd loop on cities	
	get trade demand (external trade routes)
	get cities requests (internal trade routes to/from that city)
	
3rd loop on cities
	calculate transfer ratio between Sell, Convertion, Supply, Transfer
	do transfers
	
on beginning of each player turn, after DoUnits()
	remove excedent

--]]

--===============================--
--[[ RESOURCE TRANSFER
--===============================--

Gold gained on import and export (taxes), more trade = more money, but less local bonuses

How much resources are transfered using trade routes

types:
	traders -> max efficiency
	road	|
	river	|} efficiency relative to distance
	sea		|
	air		-> smaller but fixed values not relative to distance

default values:
MAX_CARGO_PER_TRADER = 10 -- Max value for exported/imported resource per trader
EXPORTED_CARGO_PER_TRADER = 10 -- default exported units of each resources
IMPORTED_CARGO_PER_TRADER = 5 -- default imported units of each resources

UI :
    - national trading (main menu on new screen)
       - 2 general values for max quantity to export/import (ie default for all resources)
       - 2 values (max to export/import) for all resources
        - button to reset values of all resources values to general values

    - trader (list and button to unfold at bottom of new screen, button to unfold on trader screen)
       - 2 general values for max quantity to export/import (ie default for all resources)
       - 2 values (max to export/import) for each resources that this trader can access
       - button to reset values of all resources values to this trader general values
       - button to reset values of all this traders values to general values for nation

--]]

--===============================--
--[[ RESOURCES TREE
--===============================--

FOREST 	-> 	WOOD(2) 	-> 	CARPENTER 	-> 	MATERIEL(5)
JUNGLE 	-> 	WOOD(1)		->

MARSH	-> 	PLANTS(3)	->	HERBORIST	-> 	MEDICINE(1)
FOREST 	-> 	PLANTS(1)	-> 	APOTHECARY  -> 	MEDICINE(3)
JUNGLE 	-> 	PLANTS(2)	->	PHARMACY	-> 	MEDICINE(10)

DEER	->				->	WOOL		->
SHEEP	->	BUTCHERY	->	FOOD
CATTLE	->				->	LEATHER		->	CLOTHIER	->	CLOTHES
							PLANTS		->



--]]

--===============================--
--[[ STABILITY
--===============================--

local
	lower
		risk of being attacked (enemy units near the city)
		supplying personnel in time of war
		lack of food
		lack of justice (absence of related buildings)
		high taxes
		low health
		
	raise
		food variety
		luxury products variety
		low taxes
		entertainement (presence of related buildings)
		military presence (martial law)
		policies
		
global
	lower		
		below tech level of known civs
		high % of poor population
		War-weariness: % deaths from combats, % material loss from combats, asymetric war (more war weariness when attacking a smaller nation)
	raise
		above tech level of known civs
		high % of rich population
		bigger empire size compared of other known civs
		
--]]

--===============================--
--[[ SUPPLY
--===============================--

Supply line efficiency by distance
% efficiency for example at 50%
	- 50% of max personnel transfered 
	- 50% of max food, materiel, resources for vehicule transfered
	
allow diplomacy option to provide supply to foreign units, at a lesser efficiency than own units, or up to same efficiency, depending of the diplomatic option 
	
vehicles requires materiel and resources to be build
table for resources required per vehicle
	- wood
	- iron
	- steel
	- aluminum...
	
forts (with stockage) linked to city, units linked to fort

--]]

--===============================--
--[[ SUZERAINTY
--===============================--

Permanent agreement between 2 nations, 1 being considered less powerful (client score <65% of suzerain score ?)
Agreement can be revoked anytime by any party (with relation/thrust modifiers affected, may cause war), or by the client (without penalty) if its score became >85% of suzerain  

Client states types:

	+ Satellite State (modern, require same government))
		The term satellite state designates a country that is formally independent in the world,
		but under heavy political, economic and military influence or control from another country.
		- Suzerain can decide the Client diplomacy independantly of it's own (proxy war, ...)
		- de facto Non Agression Pact
		- Defensive Pact from Suzerain (more protected than a Puppet State, but how does that play with proxy war ?)
		- common Open Market	
		- common Open Borders			
	
	+ Associated state (modern) 
		An associated state is the minor partner in a formal, free relationship between a political territory with a degree of statehood and a (usually larger) nation,
		for which no other specific term, such as protectorate, is adopted.
		- Open Borders given to Suzerain
		- under complete military protection of Suzerain (give control of all its military land units, Defensive Pact from Suzerain)
		- not required to follow the Suzerain in wars
		- limited diplomacy (can't declare war independantly of Suzerain or join a different alliance than Suzerain')
		- de facto Non Agression Pact
		- common Open Market
		
	+ Puppet State (modern, can have different government)
		A puppet state is a metaphor of a state that is supposedly independent but is in fact dependent upon an outside power.
		It is nominally sovereign but effectively controlled by a foreign or otherwise alien power, for reasons such as financial interests.
		A puppet state preserves the external paraphernalia of independence like a name, flag, anthem, constitution, law codes and motto but in reality is an organ of another state which created or sponsored the government
		- Strict following of Suzerain diplomacy actions (DOW, DOF, Denounce, Embargo, ...), with lesser modifiers penalties
		- Suzerain can decide the Client diplomacy independantly of it's own (proxy war, ...)
		- Exchange Territorial Integrity and Non Agression Pact (But both exchange occupied territory before applying)
		- Open Borders given to Suzerain
		- Open Market given to Suzerain
		
	+ Colony (other continent, far from Capital city)
		In politics and history, a colony is a territory under the immediate political control of a state, distinct from the home territory of the sovereign.
		Some colonies were historically countries, while others were territories without definite statehood from their inception.
		The Metropolitan state is the state that owns the colony.
		Unlike a puppet state or satellite state, a colony has no independent international representation,
		and its top-level administration is under direct control of the metropolitan state.
		- Inherit the Diplomatic relations of the Suzerain (de faco Non Agression and Defensive Pacts but also follow in offensive wars and every diplomatic actions, including economics)
		- Open Borders given to Suzerain
		- Open Market given to Suzerain
		- Exchange Territorial Integrity
	
	+ Protectorate
		A protectorate, in its inception adopted by modern international law,
		is a dependent territory that has been granted local autonomy and some independence while still retaining the suzerainty of a greater sovereign state.
		In exchange for this, the protectorate usually accepts specified obligations, which may vary greatly, depending on the real nature of their relationship
		- Exchange Territorial Integrity
		- Exchange Non Agression Pact
		- More inclined to accept Suzerain diplomatic demands
		- Open Borders given to Suzerain
		- Open Market given to Suzerain
		- Defensive Pact from Suzerain
		
	+ Vassal State (pre-modern) -> Satellite State or Puppet State
		A vassal state is any state that is subordinate to another. The vassal in these cases is the ruler, rather than the state itself.
		Being a vassal most commonly implies providing military assistance to the dominant state when requested to do so.
		It sometimes implies paying tribute, but a state which does so is better described as a tributary state.
		In simpler terms the vassal state would have to provide military power to the dominant state.
		Today, more common terms are puppet state, protectorate or associated state.
		- Strict following of Suzerain diplomacy actions (DOW, DOF, Denounce, Embargo, ...), with lesser modifiers penalties
		- Must defend the Suzerain when attacked
		- Can have its own diplomacy (including declaration of war)
		- Exchange Territorial Integrity and Non Agression Pact (But both exchange occupied territory before applying)
		- Open Borders given to Suzerain
		- Open Market given to Suzerain
		
	+ Tributary State (pre-modern) -> Associated State or Satellite State
		The term tributary state refers to one of the two main ways in which a pre-modern state might be subordinate to a more powerful state.
		The heart of the relationship was that the tributary would send a regular token of submission (tribute) to the superior power.
		This token often took the form of a substantial transfer of wealth, such as the delivery of gold, produce, or slaves, 
		so that tribute might best be seen as the payment of protection money.
		- Give something to Suzerain (gold per turn, Open Market, ...)
		- Do not oppose Suzerain in diplomacy (Client count less negative modifiers to Suzerain action)
		- Exchange Territorial Integrity and Non Agression Pact

Hegemony as a possible victory condition ?

--]]

--===============================--
--[[ TECHNOLOGIES
--===============================--

+ Ancien
	Herbalism: Herborist (+health) - Less deads from wounds
	
+ Classical
	Surgery : Less deads from wounds
	
+ Medieval
	Medicine: Medieval Hospitals (+healths, heal wounded + cure illness in city), Apothecary (replace Herborist), Less deads from wounds
	
+ Rennaissance
	Microbiologie: Hospital (replace Medieval Hospitals), Less deads from wounds
	
+ Industrial
	Vaccine: Pharmacy (replace Apothecary), limit Epidemy start
	
+ Modern
	Antibiotics: Modern Hospital (replace Hospitals), Minimal deads from wounds

--]]

--===============================--
--[[ TERRITORY
--===============================--
	   
- First unit debarking on a small island (<4 tiles) can claim it
- Maximum distance form own cities depending on tech/civic (allow illimited range after specific tech/civic for example)

--]]

--===============================--
--[[ TRIBES/BARBARIANS
--===============================--

grouped tribal village
can spawn barbarians camps if pillaged
visiting with scout, civilian = friendly but less goodies / military units = unfriendly but more goodies ?
popup to allow choice (pay for reinforcements or pillage or no action for example ?) <- have to find a way to propagate choice on network first

--]]

--===============================--
--[[ UNITS
--===============================--

+ Creation
	- use dummy building for each unit, edit city screen to hide them (add column in building table)
	- Lua check for required resources for an unit in city at the start of a player turn to create or remove the dummy building

+ Components
	- allow excedents, but decay each turn

--]]
