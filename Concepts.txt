====================
=      UNITS       =
====================

+ Creation

- use dummy building for each unit, edit city screen to hide them (add column in building table)
- Lua check for required resources for an unit in city at the start of a player turn to create or remove the dummy building


====================
=      COMBAT      =
====================

when destroying an unit in melee attack:
- capture % of wounded left
- capture % of materiel left
- capture % of horses left
- capture % of fuel left
- transform % of damaged vehicule to materiel

when destroying an unit in ranged attack:
- % of wounded left -> defender city if linked
- everything else lost

---------------------------------------------------------------

+ Units can have more components than expected by its HP left (just put them in reserve as surplus)

- excedental reserve is transfered to city if a supply line is open
- if excedent > max active then the component is lost (that situation shouldn't happen)

example:
- desertion in a mechanized units: remove the HP corresponding to the deserting personnel and put the Vehicles corresponding to the HP lost in reserve.
- mechanical failure in case of low reliability: remove the HP corresponding to the Vehicles damaged and put the personnel corresponding to the HP lost in reserve.
- chance of ejection/escape of the crew of an aircraft/vehicule destroyed in combat situation : when removing each Vehicles corresponding to the HP lost in combat do a check and put unarmed crew in reserve (or wounded)


====================
=      Ration      =
====================

- food reserve
- get food from unit plot (or nearby plot at lower ratio)
- food requirement = ( (personnel x2) + (wounded *1.5) + (prisonners*0.5) + (horses*3) ) / 1000
- no food from owned plots
- pillaging can give food (farm, ...), materiel (mines, ...), prisonners (district, ...)

+ rationing
	if less than 50% MaxFoodStock left
		moral-, 50% food consumption, wounded mortality rate+
	if less than 25% MaxFoodStock left
		moral--, 25% food consumption, wounded mortality rate++
	if less than 10% MaxFoodStock left
		moral---, 10% food consumption, wounded mortality rate+++
		if unit has horses
			% of horses (min of 1) removed from reserve -> food 
	if no food stock
		moral----, wounded mortality rate++++
		if unit has horses
			% of horses (min of 1) removed from reserve -> food
			if no horses in reserve and more than 50 hp left in unit, remove 1hp (equivalent hp of horses removed -> food, other components transfered to reserve)

====================
=      Moral      =
====================

++ victory
++++ large victory
+++++ kill unit
- defeat
-- large defeat
- rationing
+++ friendly tribe

each turn @low morale (default = 50%) : desertion (modifiers to default: promotions, policies, ...)
	- remove 1 equivalent hp on personnel in reserve per turn until 50% MaxPersonnelReserve is reached
	- if less than 50% MaxPersonnelReserve remove 1 hp per turn until hp = 50% max (equivalent hp of personnel removed, other components transfered to reserve)
	- morale++
	
each turn
	- morale+ if less than 25% of total personnel wounded
	- morale++ if less than 5% of total personnel wounded
	- morale- if more than 50% of total personnel wounded

====================
=     Healing      =
====================

- Unit "heal" from reserve first then receive supply in reserve : "Rear" (Reinforcement / Healed / Repaired) -> Reserve -> Frontline 
- Retreating: lose all damaged Vehicles & wounded -> prisoners
- Need personnel to resuply #personnel in reserve
- Need materiel to resuply #Vehicles in reserve
- Tribal Villages (Barbarian outpost ?) should provide enough Personnel / Materiel to refill at least a Scout/Ranger reserve.

+ each turn:

	- if linked to city: 
		all wounded, prisonners (and other captured components like horses, vehicule ?) -> city (if it can handle it)
		all excedent from other components -> city (if it can handle it)
		healing 10 "equivalent HP" max / turn from reserve, reserve receive 5 "equivalent HP" max / turn from cities

		infantry
			- reserve -> personnel/materiel to frontline troops (up to 10 equivalent hp) (reserve personnel + wounded can't be superior to max frontline personnel)
			- linked city - > component (personnel, horses, materiel) to refill reserve (up to 5 equivalent hp)

		mechanized unit
			- reserve -> personnel/materiel/vehicule to frontline troops (up to 10 equivalent hp)
			- linked city -> component (personnel, materiel) to refill reserve (up to 5 equivalent hp or until MAX_MATERIEL_SUPPLIED is reached, whatever come first)
			- linked city -> materiel to repair each damaged vehicule in reserve (max 5 hp of equivalent vehicule or until MAX_MATERIEL_SUPPLIED is reached, whatever come first)
			- linked city -> materiel ("vehicule production" here) to reserve (if not reached the 5 hp/turn limit or until MAX_MATERIEL_SUPPLIED is reached, whatever come first)

		note: materiel in reserve is only used to repair, not to make a new vehicule "on the field"

	- if not linked to city: 

		wounded -> % healed to reserve personnel (if medic/field hospital promotion)
		wounded -> % dead (more important without medic/field hospital promotion, lowered at higher eras)

		healing 10 "equivalent HP" max / turn from reserve

		infantry
			- reserve -> personnel/materiel to frontline troops (up to 10 equivalent HP)

		mechanized unit
			- reserve -> personnel/materiel/vehicule to frontline troops (up to 10 equivalent hp)
			- reserve -> materiel to repair each damaged vehicule (up to 5 equivalent vehicule HP)
			if no materiel in reserve, "bleed" unit
		


====================
=   Promotions     =
====================

- berserk/totenkopf : +25% chance of causing retreat, more dead, less prisonners, less wounded 


====================
=  Technologies    =
====================

+ Ancien
	Herbalism: Herborist (+health) - Less deads from wounds
	
+ Classical
	Surgery : Less deads from wounds
	
+ Medieval
	Medecine: Medieval Hospitals (+heals, heal wounded in city), Apothecary (replace Herborist), Less deads from wounds
	
+ Rennaissance
	Microbiologie: Hospital (replace Medieval Hospitals), Less deads from wounds
	
+ Industrial
	Vaccine: Pharmacy (replace Apothecary)
	
+ Modern
	Antibiotics: Modern Hospital (replace Hospitals), Minimal deads from wounds
	

====================
=    Buildings     =
====================

+ Resources creation

	- Iron stock in city -> Iron Smith -> produce Materiel
	- Iron & coal stock in city -> Steel Factory -> produce Steel

+ Resource stock

	- New table 'BuildingStock' ('BuildingType', 'ResourceType', 'Value')
	- Granary -> can stock 15 units of Rice, Wheat

+ replacing building
	- bonus in prod when previous building in city
	- lua script to replace the old building on completion

====================
=      Budget      =
====================


calculate need (ie maintenance cost, then bonus if superior, malus if inferior)

military :
	- moral (combat: retreat)
	- reliability (mechanized need less materiel to repair, vehicule can become damaged each turn)
	- loyalty (desertion, rebellion, linked to moral and empire stability)

culture

diplomacy

intelligence

entertainement

science

infrastructure : 
	- if not enough budget, roads, buildings, improvements can be damaged (decay rate)
	- lower auto-repair time)


====================
= Resources stock  =
====================

how to find which resources can be sold & which can be bought

- slider to sell until X % of stock left 
- slider to buy until Y % of stock filled
- slider to convert to another resource until Z % of stock left

converting a resource (in buildings like steel factory using coal and iron) has priority, so to always have a stock to sell, set Z > X, but the number of converted / buyed resources is limited per turn

for example a market could allows 10 units of each resources / turn or a stock exchange 100 units of each resources / turn


if X > Y 
    - will buy until Y % of stock filled
    - will sell until X % of stock left
    - and means will not buy if it's selling
if X < Y 
    - will always buy until Y % of stock filled
    - will sell until X % of stock left
    - can buy and sell at the same time

so maybe force X >= Y every time (if X = Y = % stock left -> no buying nor selling)

default values:
PERCENTAGE_STOCK_REQUIRED_TO_SELL = 50
PERCENTAGE_STOCK_REQUIRED_TO_CONVERT = 40
PERCENTAGE_STOCK_REQUIRED_TO_STOP_BUYING = 50

UI :
    - national stock (main menu on new screen)
       - general slider for nation (ie default for all resources)
       - sliders for all resources (when used not updated by general slider)
       - button to reset values of all resources slider to general slider
    - city stock (list and button to unfold at bottom of new screen)
       - general slider for city (ie default for all resources in city - override general slider for nation at the city level)
       - sliders for all resources (when used they are not updated by general slider)
       - button to reset values of all resources slider to general slider for city
       - button to reset value of general slider for city to general slider for nation
       - button to reset values of all sliders of this city to general slider for nation

====================
=Resource Transfert=
====================

How much resources are transfered using trade routes

default values:
MAX_CARGO_PER_TRADER = 10 -- Max value for exported/imported resource per trader
EXPORTED_CARGO_PER_TRADER = 10 -- default exported units of each resources
IMPORTED_CARGO_PER_TRADER = 5 -- default imported units of each resources

UI :
    - national trading (main menu on new screen)
       - 2 general values for max quantity to export/import (ie default for all resources)
       - 2 values (max to export/import) for all resources
        - button to reset values of all resources values to general values

    - trader (list and button to unfold at bottom of new screen, button to unfold on trader screen)
       - 2 general values for max quantity to export/import (ie default for all resources)
       - 2 values (max to export/import) for each resources that this trader can access
       - button to reset values of all resources values to this trader general values
       - button to reset values of all this traders values to general values for nation

====================
=      Economy     =
====================

4 classes: upper, middle, lower, slave (prisonners of war, policy dependant)

rich (max % from middle+poor), middle (default), poor
rich give more gold from tax
poor, slave give no gold from tax
building / luxury resources / tax : change rate (per turn) of convertion from middle to rich/poor
poor give unrest/unhappiness
slaves give extra production, raise unrest

Taxe rate used to determine gold the change rate

default value
BASE_GOLD_PER_RICH_CITIZEN = 100
BASE_TAXE_RICH_CLASS = 10

BASE_GOLD_PER_MIDDLE_CLASS_CITIZEN = 10
BASE_TAXE_RICH_CLASS = 10

UI :
    - national taxe rate
       - 2 values for rich/middle class taxe rate
    - city taxe rate
       - 2 values for rich/middle class taxe rate
       - 1 button to reset city values to national values
	   
+ Corruption

Large empire raise corruption
Corruption lower incomes (maybe only if the budget is positif ?)	   

+ Banditism

some entertainement buildings raise banditism (taverns, whorehouses, nightclubs, ...)
banditism raise corruption
	   
====================
=  Programmation   =
====================
	   
